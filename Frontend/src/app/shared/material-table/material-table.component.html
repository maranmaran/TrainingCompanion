<mat-form-field>
    <input matInput (keyup)="applyFilterEvent.next($event.target.value)" placeholder="Filter">
</mat-form-field>

<div class="mat-elevation-z1">

    <mat-table [dataSource]="datasource" matSort>

        <!-- SELECTION ( CHECKBOXES ) -->
        <ng-container matColumnDef="select" *ngIf="config.selectionEnabled">
            <mat-header-cell *matHeaderCellDef>
                <mat-checkbox (change)="$event ? masterToggle() : null"
                    [checked]="selection.hasValue() && isAllSelected"
                    [indeterminate]="selection.hasValue() && !isAllSelected">
                </mat-checkbox>
            </mat-header-cell>
            <mat-cell *matCellDef="let row">
                <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row.id) : null"
                    [checked]="selection.isSelected(row.id)">
                </mat-checkbox>
            </mat-cell>
        </ng-container>

        <!-- ACTUAL DATA -->
        <ng-container *ngFor="let col of columns" matColumnDef="{{ col.definition }}">

            <ng-container *ngIf="col.sort">
                <mat-header-cell class="{{col.headerClass}}" *matHeaderCellDef mat-sort-header> {{ col.title }} </mat-header-cell>
            </ng-container>

            <ng-container *ngIf="!col.sort">
                <mat-header-cell class="{{col.headerClass}}" *matHeaderCellDef> {{ col.title }} </mat-header-cell>
            </ng-container>

            <mat-cell class="{{col.cellClass}}" *matCellDef="let row"> <div [innerHtml]="(col.displayFunction(row) | sanitizeHtml)"></div> </mat-cell>

        </ng-container>

        <!-- ACTIONS -->
        <ng-container matColumnDef="actions" *ngIf="config.actionsEnabled">
            <!--HEADER ACTIONS-->
            <mat-header-cell *matHeaderCellDef>

         
            <button mat-icon-button color="accent" [matMenuTriggerFor]="headerMenu" >
                    <i class="fa fa-ellipsis-v"></i>
            </button>

            <mat-menu #headerMenu="matMenu">
                <button mat-icon-button *ngIf="config.addEnabled" color="accent" (click)="addEvent.emit()" (click)="$event.stopPropagation()">
                    <i class="fas fa-plus"></i>
                </button>
                <button mat-icon-button *ngIf="deleteManyVisible" (click)="onDeleteSelection()" color="accent" (click)="$event.stopPropagation()">
                    <i class="fas fa-trash"></i>
                </button>
            </mat-menu>

              
            </mat-header-cell>

            <!--CELL ACTIONS-->
            <mat-cell *matCellDef="let row">

                <button mat-icon-button color="accent" [matMenuTriggerFor]="cellMenu" >
                        <i class="fa fa-ellipsis-v"></i>
                </button>
    
                <mat-menu #cellMenu="matMenu">
                    <button *ngIf="config.editEnabled" mat-icon-button color="accent" (click)="updateEvent.emit(row)" (click)="$event.stopPropagation()">
                        <i class="fas fa-edit"></i>
                    </button>
                    <button *ngIf="config.deleteEnabled" mat-icon-button color="accent" (click)="deleteEvent.emit(row)"
                        (click)="$event.stopPropagation()">
                        <i class="fas fa-trash"></i>
                    </button>
                </mat-menu>

            </mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="displayColumns"></mat-header-row>
        <mat-row highlightOnHover [class.selected-row]="selection.isSelected(row.id)"
            *matRowDef="let row; columns: displayColumns;" (click)="onSelect(row)">
        </mat-row>

    </mat-table>

    <div class="no-records" *ngIf="datasourceEmpty">
        <span>No records</span>
    </div>

    <mat-paginator [hidden]="paginatorHidden" showFirstLastButtons
        [pageSize]="pageSize" [length]="datasource.data.length" [pageSizeOptions]="[5, 10, 15]"></mat-paginator>
</div>